# ─────────────────────────────────────────────
# Garbanzo Bot — Environment Variables
# Copy this to .env and fill in real values
# Default deployment is Docker Compose (`docker compose up -d`)
# ─────────────────────────────────────────────

# ── Messaging Platform ───────────────────────
# Production runtime today: whatsapp
# Slack/Discord can run on official APIs once credentials are configured.
# Local demo runtimes are still available for offline pipeline testing:
#   MESSAGING_PLATFORM=slack   + SLACK_DEMO=true
#   MESSAGING_PLATFORM=discord + DISCORD_DEMO=true
# Adapter target reserved for future work: teams
MESSAGING_PLATFORM=whatsapp

# ── AI Providers ──────────────────────────────
# Cloud AI (configure at least one).
# Failover order is configurable via AI_PROVIDER_ORDER (openrouter, anthropic, openai, gemini, bedrock).
ANTHROPIC_API_KEY=
OPENROUTER_API_KEY=
OPENAI_API_KEY=
AI_PROVIDER_ORDER=openrouter,anthropic,openai

# Optional model overrides
ANTHROPIC_MODEL=claude-sonnet-4-5-20250514
OPENROUTER_MODEL=anthropic/claude-sonnet-4-5
OPENAI_MODEL=gpt-4.1

# Gemini (Google AI Studio key)
GEMINI_API_KEY=
GEMINI_MODEL=gemini-1.5-flash
# Pricing (USD per 1M tokens). Default 0 until you configure it.
GEMINI_PRICING_INPUT_PER_M=0
GEMINI_PRICING_OUTPUT_PER_M=0
# Global cloud guardrails
CLOUD_MAX_TOKENS=1024
CLOUD_REQUEST_TIMEOUT_MS=30000

# Bedrock (AWS credentials via environment/profile/instance role)
# Add "bedrock" to AI_PROVIDER_ORDER when enabled.
BEDROCK_REGION=us-east-1
BEDROCK_MODEL_ID=
BEDROCK_MAX_TOKENS=1024
# Pricing (USD per 1M tokens). Default 0 until you configure it.
BEDROCK_PRICING_INPUT_PER_M=0
BEDROCK_PRICING_OUTPUT_PER_M=0

# ── WhatsApp ──────────────────────────────────
# Phone number the bot is registered with (include country code)
BOT_PHONE_NUMBER=

# ── Feature API Keys ─────────────────────────
# Weather (Google Cloud Weather + Geocoding APIs)
GOOGLE_API_KEY=

# Public transit (MBTA v3 — free key at api-v3.mbta.com/portal)
MBTA_API_KEY=

# News search (newsapi.org — free: 100 req/day)
NEWSAPI_KEY=

# Web search (Brave Search API)
BRAVE_SEARCH_API_KEY=

# ── Optional owner links/messages ────────────
# These values are used only by owner-side messaging commands.
GITHUB_SPONSORS_URL=
PATREON_URL=
KOFI_URL=
SUPPORT_CUSTOM_URL=
SUPPORT_MESSAGE=

# Optional feedback -> GitHub issue automation (owner-approved)
GITHUB_ISSUES_TOKEN=
GITHUB_ISSUES_REPO=owner/repo

# ── Infrastructure ───────────────────────────
# Ollama endpoint (local inference on Terra)
OLLAMA_BASE_URL=http://127.0.0.1:11434

# Database
DB_DIALECT=sqlite
# Postgres (optional): set either DATABASE_URL or POSTGRES_* fields.
DATABASE_URL=
POSTGRES_HOST=
POSTGRES_PORT=5432
POSTGRES_DB=
POSTGRES_USER=
POSTGRES_PASSWORD=
# Required for RDS defaults when rds.force_ssl=1
POSTGRES_SSL=false
# Set true only if you provide trusted CA bundle in runtime
POSTGRES_SSL_REJECT_UNAUTHORIZED=false

# Conversation session memory (Phase 1)
CONTEXT_SESSION_MEMORY_ENABLED=true
CONTEXT_SESSION_GAP_MINUTES=30
CONTEXT_SESSION_MIN_MESSAGES=4
CONTEXT_SESSION_MAX_RETRIEVED=3
CONTEXT_SESSION_SUMMARY_VERSION=1

# Embedding pipeline (Phase 2 starter)
# deterministic = local hash embedding (default)
# openai = text-embedding-3-* via OPENAI_API_KEY
VECTOR_EMBEDDING_PROVIDER=deterministic
VECTOR_EMBEDDING_MODEL=text-embedding-3-small
VECTOR_EMBEDDING_TIMEOUT_MS=12000
VECTOR_EMBEDDING_MAX_CHARS=4000

# Health endpoint (for local probes / Uptime Kuma)
HEALTH_PORT=3001
# Default localhost only; set to 0.0.0.0 when monitoring from another host.
HEALTH_BIND_HOST=127.0.0.1

# Prometheus-style metrics (served from the health server at /metrics)
METRICS_ENABLED=false

# ── Slack official runtime ───────────────────
# Requires a Slack app with Events API + bot token scopes.
SLACK_BOT_TOKEN=
SLACK_SIGNING_SECRET=
# Optional bot user id (format U...), used for mention parsing override.
SLACK_BOT_USER_ID=
# Token rotation (required when Slack issues 12-hour access tokens)
SLACK_CLIENT_ID=
SLACK_CLIENT_SECRET=
SLACK_REFRESH_TOKEN=
SLACK_TOKEN_STATE_FILE=data/slack-token-state.json
SLACK_TOKEN_ROTATE_MIN_BUFFER=5
SLACK_EVENTS_PORT=3002
SLACK_EVENTS_BIND_HOST=127.0.0.1

# ── Slack demo runtime (local dev only) ───────
SLACK_DEMO=false
SLACK_DEMO_PORT=3002
SLACK_DEMO_BIND_HOST=127.0.0.1
# Optional CAPTCHA challenge for public demo deployments
DEMO_TURNSTILE_ENABLED=false
DEMO_TURNSTILE_SITE_KEY=
DEMO_TURNSTILE_SECRET_KEY=

# ── Discord official runtime ──────────────────
# Uses Interaction endpoint + bot token sends.
DISCORD_BOT_TOKEN=
DISCORD_PUBLIC_KEY=
DISCORD_INTERACTIONS_PORT=3003
DISCORD_INTERACTIONS_BIND_HOST=127.0.0.1

# ── Discord demo runtime (local dev only) ─────
DISCORD_DEMO=false
DISCORD_DEMO_PORT=3003
DISCORD_DEMO_BIND_HOST=127.0.0.1

# Log level: debug | info | warn | error
LOG_LEVEL=info

# Optional app/version marker used in release notes and image labels
APP_VERSION=0.1.0

# Owner identifier for admin DMs/alerts.
# WhatsApp: your_number@s.whatsapp.net
# Slack/Discord: use your platform user id or channel id for alerts.
OWNER_JID=your_number@s.whatsapp.net
